@let breakpoint = breakpoint$ | async;
<div
    tuiAppearance="whiteblock"
    tuiCardLarge="normal"
    class="card"
>
    <div>
        <h6 class="tui-space_bottom-0 tui-space_top-0 card-heading">Top ranked</h6>
        <div
            tuiCarouselButtons
            class="wrapper"
        >
            @if (breakpoint) {
                <div class="top-select">
                    <button
                        iconStart="@tui.chevron-left"
                        tuiIconButton
                        type="button"
                        class="button button_left"
                        (click)="carouselTop.prev()"
                    ></button>
                    <tui-carousel
                        #carouselTop
                        [draggable]="false"
                        [itemsCount]="breakpoint === 'mobile' ? 1 : breakpoint === 'desktopSmall' ? 2 : 3"
                        [(index)]="indexTop"
                    >
                        @for (item of listFilmsService; track $index) {
                            <div
                                *tuiItem
                                draggable="false"
                                class="item"
                                [class.item_active]="$index === openTop"
                                [ngStyle]="{'background-image': 'url(' + item.img + ')'}"
                                (click)="openTop = $index"
                            ></div>
                        }
                    </tui-carousel>
                    <button
                        iconStart="@tui.chevron-right"
                        tuiIconButton
                        type="button"
                        class="button button_right"
                        (click)="carouselTop.next()"
                    >
                        Next
                    </button>
                </div>
            }
        </div>
        <tui-expand [expanded]="openTop !== -1">
            <ng-template tuiExpandContent>
                @let item = listFilmsService[openTop];
                <hr />
                <div
                    tuiSurface
                    class="block-info"
                >
                    <div class="info">
                        <header tuiHeader="l">
                            <h2 tuiTitle>
                                {{ item.title }}
                            </h2>
                        </header>
                        <div class="info-small">
                            <p
                                class="tui-space_top-0 tui-space_bottom-0"
                                [style.color]="'var(--tui-status-positive)'"
                                [style.font-weight]="'800'"
                            >
                                {{ item.rating }}
                            </p>
                            <p
                                class="tui-space_top-0 tui-space_bottom-0"
                                [style.font-weight]="'300'"
                                [style.white-space]="'nowrap'"
                            >
                                {{ item.year }}, {{ item.genre }}
                            </p>
                            <p
                                class="tui-space_top-0 tui-space_bottom-0"
                                [style.font-weight]="'300'"
                            >
                                {{ item.country }}
                            </p>
                            <p
                                class="tui-space_top-0 tui-space_bottom-0"
                                [style.font-weight]="'300'"
                            >
                                {{ item.durationMinutes * 1000 * 60 | date: 'H:mm' : 'UTC' }}
                            </p>
                            <p
                                class="tui-space_top-0 tui-space_bottom-0"
                                [style.font-weight]="'300'"
                            >
                                {{ item.restrictionsYears }}+
                            </p>
                        </div>
                        <tui-rating
                            class="rating"
                            [max]="10"
                            [ngModel]="item.rating"
                            [readOnly]="true"
                        />
                        <header
                            tuiHeader="m"
                            class="tui-space_top-4"
                        >
                            <h3
                                tuiTitle
                                [style.font-size]="'1.6rem'"
                                [style.font-weight]="'300'"
                                [style.max-width]="'35rem'"
                            >
                                {{ item.description }}
                            </h3>
                        </header>
                        <button
                            appearance="primary"
                            tuiButton
                            class="button-watch"
                            [routerLink]="'/dashboards/films/' + openTop"
                        >
                            Watch
                        </button>
                    </div>
                    <div
                        class="background-img"
                        [ngStyle]="{'background-image': 'url(' + item.img + ')'}"
                    >
                        <button
                            appearance="icon"
                            iconStart="@tui.circle-x"
                            tuiIconButton
                            class="close"
                            (click)="openTop = -1"
                        ></button>
                    </div>
                </div>
            </ng-template>
        </tui-expand>
    </div>
</div>
<div
    tuiAppearance="whiteblock"
    tuiCardLarge="normal"
    class="card"
>
    <div>
        <h6 class="tui-space_bottom-0 tui-space_top-0 card-heading">Movies for you</h6>
        <div
            tuiCarouselButtons
            class="wrapper"
        >
            @if (breakpoint) {
                <div class="top-select">
                    <button
                        iconStart="@tui.chevron-left"
                        tuiIconButton
                        type="button"
                        class="button button_left"
                        (click)="carouselBottom.prev()"
                    ></button>
                    <tui-carousel
                        #carouselBottom
                        [draggable]="false"
                        [itemsCount]="breakpoint === 'mobile' ? 1 : breakpoint === 'desktopSmall' ? 2 : 3"
                        [(index)]="indexBottom"
                    >
                        @for (item of listFilmsService; track $index) {
                            <div
                                *tuiItem
                                draggable="false"
                                class="item"
                                [class.item_active]="$index === openBottom"
                                [ngStyle]="{'background-image': 'url(' + item.img + ')'}"
                                (click)="openBottom = $index"
                            ></div>
                        }
                    </tui-carousel>
                    <button
                        iconStart="@tui.chevron-right"
                        tuiIconButton
                        type="button"
                        class="button button_right"
                        (click)="carouselBottom.next()"
                    >
                        Next
                    </button>
                </div>
            }
        </div>
        <tui-expand [expanded]="openBottom !== -1">
            <ng-template tuiExpandContent>
                @let item = listFilmsService[openBottom];
                <hr />
                <div
                    tuiSurface
                    class="block-info"
                >
                    <div class="info">
                        <header tuiHeader="l">
                            <h2 tuiTitle>
                                {{ item.title }}
                            </h2>
                        </header>
                        <div class="info-small">
                            <p
                                class="tui-space_top-0 tui-space_bottom-0"
                                [style.color]="'var(--tui-status-positive)'"
                                [style.font-weight]="'800'"
                            >
                                {{ item.rating }}
                            </p>
                            <p
                                class="tui-space_top-0 tui-space_bottom-0"
                                [style.font-weight]="'300'"
                                [style.white-space]="'nowrap'"
                            >
                                {{ item.year }}, {{ item.genre }}
                            </p>
                            <p
                                class="tui-space_top-0 tui-space_bottom-0"
                                [style.font-weight]="'300'"
                            >
                                {{ item.country }}
                            </p>
                            <p
                                class="tui-space_top-0 tui-space_bottom-0"
                                [style.font-weight]="'300'"
                            >
                                {{ item.durationMinutes * 1000 * 60 | date: 'H:mm' : 'UTC' }}
                            </p>
                            <p
                                class="tui-space_top-0 tui-space_bottom-0"
                                [style.font-weight]="'300'"
                            >
                                {{ item.restrictionsYears }}+
                            </p>
                        </div>
                        <tui-rating
                            class="rating"
                            [max]="10"
                            [ngModel]="item.rating"
                            [readOnly]="true"
                        />
                        <header
                            tuiHeader="m"
                            class="tui-space_top-4"
                        >
                            <h3
                                tuiTitle
                                [style.font-size]="'1.6rem'"
                                [style.font-weight]="'300'"
                                [style.max-width]="'35rem'"
                            >
                                {{ item.description }}
                            </h3>
                        </header>
                        <button
                            appearance="primary"
                            tuiButton
                            class="button-watch"
                            [routerLink]="'/dashboards/films/' + openTop"
                        >
                            Watch
                        </button>
                    </div>
                    <div
                        class="background-img"
                        [ngStyle]="{'background-image': 'url(' + item.img + ')'}"
                    >
                        <button
                            appearance="icon"
                            iconStart="@tui.circle-x"
                            tuiIconButton
                            class="close"
                            (click)="openBottom = -1"
                        ></button>
                    </div>
                </div>
            </ng-template>
        </tui-expand>
    </div>
</div>
